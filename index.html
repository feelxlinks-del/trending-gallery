<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Trending Video Gallery</title>

<style>
*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
body{margin:0;background:#0f0f0f;color:#fff}

.header{padding:12px;text-align:center;font-size:20px;font-weight:bold}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:12px;
  padding:12px;
}

.card{
  position:relative;
  border-radius:10px;
  overflow:hidden;
  background:#000;
}

.card video{
  width:100%;
  height:230px;
  object-fit:cover;
}

.preview{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.5);
  display:none;
  align-items:center;
  justify-content:center;
  font-size:14px;
}

.card.active .preview{display:flex}

.player-page{display:none}

.back-btn{
  padding:10px;
  background:#ff0066;
  border:none;
  color:#fff;
  border-radius:6px;
  margin:10px;
}

</style>
</head>
<body>

<div class="header">Trending Video Gallery</div>

<!-- GRID PAGE -->
<div id="gridPage" class="grid"></div>

<!-- PLAYER PAGE -->
<div id="playerPage" class="player-page">
  <button class="back-btn" onclick="goBack()">â¬… Back</button>
  <video id="mainVideo" controls autoplay style="width:100%;max-height:60vh"></video>
  <div class="grid" id="relatedGrid"></div>
</div>

<script>
const REDIRECT_URL = "https://37896.lominglaes.com/4/267540";
const videos = [
  'video1.mp4','video2.mp4','video3.mp4','video4.mp4','video5.mp4'
];

let redirected = sessionStorage.getItem('redirected');

function redirectNow(){
  sessionStorage.setItem('redirected','yes');
  window.location.href = REDIRECT_URL;
}

function createCard(src, index){
  const card = document.createElement('div');
  card.className = 'card';

  const video = document.createElement('video');
  video.src = src;
  video.muted = true;
  video.playsInline = true;

  const preview = document.createElement('div');
  preview.className = 'preview';
  preview.innerText = 'Preview';

  let pressTimer;

  /* FIRST CLICK REDIRECT */
  card.addEventListener('click',()=>{
    if(!redirected){redirectNow();return;}
    openPlayer(src);
  });

  /* LONG PRESS = 10s PREVIEW */
  card.addEventListener('touchstart',()=>{
    pressTimer = setTimeout(()=>{
      card.classList.add('active');
      video.play();
      setTimeout(()=>video.pause(),10000);
    },400);
  });

  card.addEventListener('touchend',()=>{
    clearTimeout(pressTimer);
    card.classList.remove('active');
    video.pause();
    video.currentTime = 0;
  });

  card.append(video,preview);
  return card;
}

function loadGrid(){
  const grid = document.getElementById('gridPage');
  grid.innerHTML='';
  videos.forEach((v,i)=>grid.appendChild(createCard(v,i)));
}

function openPlayer(src){
  document.getElementById('gridPage').style.display='none';
  document.getElementById('playerPage').style.display='block';
  const main = document.getElementById('mainVideo');
  main.src = src;
  monitorVideo(main);
  loadRelated();
}

function loadRelated(){
  const rel = document.getElementById('relatedGrid');
  rel.innerHTML='';
  videos.forEach(v=>rel.appendChild(createCard(v)));
}

function goBack(){
  document.getElementById('playerPage').style.display='none';
  document.getElementById('gridPage').style.display='grid';
}

/* FAST FORWARD & SEEK REDIRECT */
function monitorVideo(video){
  let seekCount = 0;
  video.addEventListener('seeking',()=>{
    seekCount++;
    if(seekCount>=4) redirectNow();
  });
}

loadGrid();
</script>
</body>
</html>
